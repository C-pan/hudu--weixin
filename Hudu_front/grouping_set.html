<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>分组排序设置</title>
    <link rel="stylesheet" href="css/reset.css"/>
    <link rel="stylesheet" href="css/grouping_set.css"/>
</head>
<body>
    <section class="section">
        <nav class="nav">
            <ul class="clearfix">
                <li>
                    <a href="#">职务设置</a>
                </li>
                <li></li>
                <li>
                    <img src="img/sort.png" alt="排序"/>
                    <a href="#">分组排序</a>
                    <i></i>
                </li>
            </ul>
            <p class="nav_title">上下拖动条目进行排序</p>
        </nav>
        <div class="list">
            <ul class="list_ul">
                <li>
                    <div class="list-menu clearfix">
                        <div>
                            <img src="img/nav.png" class="list-menu_nav" alt="菜单"/>
                            会领导
                        </div>
                        <div class="list_ul_menu">
                            <span>01</span>
                            <img src="img/menu.png" alt="菜单"/>
                        </div>
                        <i data-open="false"></i>
                    </div>
                    <div class="list-submenu">
                        <ul class="list_ul1">
                            <li>
                                <div>
                                    会长
                                </div>
                                <div class="list_ul1_menu">
                                    <span>01</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    处长
                                </div>
                                <div class="list_ul1_menu">
                                    <span>02</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    希鹏
                                </div>
                                <div class="list_ul1_menu">
                                    <span>03</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="list-menu clearfix">
                        <div>
                            <img src="img/nav.png" class="list-menu_nav" alt="菜单"/>
                            顾问专家
                        </div>
                        <div class="list_ul_menu">
                            <span>02</span>
                            <img src="img/menu.png" alt="菜单"/>
                        </div>
                        <i data-open="false"></i>
                    </div>
                    <div class="list-submenu">
                        <ul class="list_ul2">
                            <li>
                                <div>
                                    会长
                                </div>
                                <div class="list_ul2_menu">
                                    <span>01</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    处长
                                </div>
                                <div class="list_ul2_menu">
                                    <span>02</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    希鹏
                                </div>
                                <div class="list_ul2_menu">
                                    <span>03</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="list-menu clearfix">
                        <div>
                            <img src="img/nav.png" class="list-menu_nav" alt="菜单"/>
                            理事会
                        </div>
                        <div class="list_ul_menu">
                            <span>03</span>
                            <img src="img/menu.png" alt="菜单"/>
                        </div>
                        <i data-open="false"></i>
                    </div>
                    <div class="list-submenu">
                        <ul class="list_ul3">
                            <li>
                                <div>
                                    会长
                                </div>
                                <div class="list_ul3_menu">
                                    <span>01</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    处长
                                </div>
                                <div class="list_ul3_menu">
                                    <span>02</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    希鹏
                                </div>
                                <div class="list_ul3_menu">
                                    <span>03</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="list-menu clearfix">
                        <div>
                            <img src="img/nav.png" class="list-menu_nav" alt="菜单"/>
                            秘书处
                        </div>
                        <div class="list_ul_menu">
                            <span>04</span>
                            <img src="img/menu.png" alt="菜单"/>
                        </div>
                        <i data-open="false"></i>
                    </div>
                    <div class="list-submenu">
                        <ul class="list_ul4">
                            <li>
                                <div>
                                    会长
                                </div>
                                <div class="list_ul4_menu">
                                    <span>01</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    处长
                                </div>
                                <div class="list_ul4_menu">
                                    <span>02</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                            <li>
                                <div>
                                    希鹏
                                </div>
                                <div class="list_ul4_menu">
                                    <span>03</span>
                                    <img src="img/submenu.png" alt="菜单"/>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </section>

	<script src="js/zepto.js"></script>
	<script src="js/public.js"></script>
    <script src="js/Sortable.js"></script>
    <script>
        $('.list-menu i').on('click',function(e){
            var tar = e.target
            if( $(tar).attr('data-open') == 'false'){
                $(tar).attr('data-open', 'true')
                $(tar).parent('.list-menu').next().css('display', 'block')
                $(tar).siblings().children('.list-menu_nav').attr('src', 'img/nav_xuanzhong.png')
                $(tar).parents('li').siblings('li').children('.list-submenu').css('display', 'none')
                $(tar).parents('li').siblings('li').find('.list-menu_nav').attr('src', 'img/nav.png')
                $(tar).parents('li').siblings('li').find('i').attr('data-open', 'false')
            }else{
                $(tar).attr('data-open', 'false')
                $(tar).parent('.list-menu').next().css('display', 'none')
                $(tar).prev().prev().children('img').attr('src', 'img/nav.png')
            }
        })

//        console.log($('.list-menu i'))
//        $('.list-menu i')[0].ontouchmove(function(){
//        	console.log(1)
//        })
      function liNumPaixu(dom){
      	for(var i = 0; i < dom.length; i++){
      		$(dom[i]).find('span').html('0'+(i+1))
      	}
      }
      function paixu(ulEle, liEle){
				new Sortable.create( $(ulEle)[0], {
//					handle: liEle,
					animation: 150,
					preventOnFilter: true,
					onEnd: function (evt){
      			console.log(evt.target)
						var liList = $(evt.target).children('li')
						liNumPaixu(liList)
						//console.log(evt.oldIndex)
			      // var oldBgcolor = $(evt.target).css('background')
			      // var start = oldBgcolor.indexOf('rgb') + 5
			      // var end = oldBgcolor.indexOf(')') + 1
			      // newBgcolor = oldBgcolor.slice(start, end)
			      // var arr = newBgcolor.split(',')
			      // var r = arr[1] + 10
			     	// var g = arr[2] + 10
			     	// var b = arr[3] + 10
			      // $(evt.target).css({background: 'rgb('+r+','+g+','+b+')'})
			    }
				});
	    }
      paixu( '.list_ul', '.list_ul_menu')
      paixu( '.list_ul1', '.list_ul1_menu')
      paixu( '.list_ul2', '.list_ul2_menu')
      paixu( '.list_ul3', '.list_ul3_menu')
      paixu( '.list_ul4', '.list_ul4_menu')

    </script>
<script>


</script>
</body>
</html>