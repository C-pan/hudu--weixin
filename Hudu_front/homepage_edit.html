<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, user-scalable=no" />
	<title>官网编辑</title>
	<link rel="stylesheet" href="css/reset.css" />
	<link rel="stylesheet" href="css/homepage_edit.css" />
	<link rel="stylesheet" href="css/swiper-3.4.1.min.css" />
	<!-- Demo styles -->
</head>
<body>
	<section class="section">
		<section class="section-banner">
			<div class="swiper-container">
				<div class="swiper-wrapper">
					<input type="file" accept="image/*" id='upload_img'>
					<div class="swiper-slide">
						<div class="swiper-slide-main">
							<p>
								<img class="swiper-slide-img" src="img/member_banner_1.jpg" alt=""/>
							</p>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<img src="img/home_banner1.jpg" alt="首页轮播图"/>
						</div>
					</div>
					<div class="swiper-slide">
						<div class="swiper-slide-main">
							<p>
								<img class="swiper-slide-img" src="img/member_banner_1.jpg" alt=""/>
							</p>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<img src="img/home_banner1.jpg" alt="首页轮播图"/>
						</div>
					</div>
					<div class="swiper-slide">
						<div class="swiper-slide-main">
							<p>
								<img class="swiper-slide-img" src="img/member_banner_1.jpg" alt=""/>
							</p>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<div>
								<p>输入会员企业图文介绍</p>
								<textarea></textarea>
							</div>
							<img src="img/home_banner1.jpg" alt="首页轮播图"/>
						</div>
					</div>
				</div>
				<div class="swiper-pagination"></div>
			</div>
		</section>
		<section class="section-main">
			<ul class="clearfix">
				<li data-url="http-10" style="background: red">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/editor_contactwe.png" alt="">
					<span>阿什顿飞</span>
				</li>
				<li data-url="http-11" style="background: blue">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/editor_chanew.png" alt="">
					<span>刚好如果</span>
				</li>
				<li data-url="http-12">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/editor_chacom.png" alt="">
					<span>儿歌</span>
				</li>
				<li data-url="http-13">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/editor_applymem.png" alt="">
					<span>问的</span>
				</li>
				<li data-url="http-14">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/editor_chaactivity.png" alt="">
					<span>如何</span>
				</li>
				<li data-url="http-15">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/back_fun_05.png" alt="">
					<span>火热呵呵</span>
				</li>
				<li data-url="http-16">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/back_fun_05.png" alt="">
					<span>如何</span>
				</li>
				<li data-url="http-17">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/back_fun_05.png" alt="">
					<span>建挺感人</span>
				</li>
				<li data-url="http-18">
					<img src="img/xiugai.png" alt="" class="open-modal">
					<img src="img/back_fun_05.png" alt="">
					<span>就突然</span>
				</li>
			</ul>
		</section>
	</section>
	<footer class="footer">
		<ul class="clearfix">
			<li class="bgy"><a href="./replace_latex.html">更换九宫</a></li>
			<li class="bgg"><a href="./editor_column.html">编辑栏目</a></li>
			<li class="bgg"><a href="./replace_shuffling.html">更换轮播</a></li>
		</ul>
	</footer>
	<div class="model-box">
		<div class="model-wrapper" data-wrapper="wrapper">
			<div class="model-content">
				<ul class="model-content-info">
					<li>
						<input type="text" placeholder="栏目名" id="chamber-name" oninput="_editorName(this)"/>
					</li>
					<li>
						<div>
							<span>背景色</span>
							<div>
								<input readonly id="chamber-bgcolor" class="jscolor" value="rgb(216, 117, 112)">
								<img src="img/list_dow.png" alt="xuanzhe"/>
							</div>
						</div>
					</li>
					<li>
						<div class="open-sel" data-open="0">
							<span>小图标</span>
							<div>
								<img src="img/back_07.png" alt="小图标" id="chamber-img"/>
								<img src="img/list_dow.png" alt="xuanzhe"/>
							</div>
						</div>
						<div class="select-list">
							<i></i>
							<ul class="clearfix" data-info="img">
								<li>
									<img src="img/editor_applymem.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_chanew.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_contactwe.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_applymem.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_chanew.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_contactwe.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_applymem.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_chanew.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_contactwe.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_applymem.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_chanew.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_contactwe.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_applymem.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_chanew.png" alt="小图标"/>
								</li>
								<li>
									<img src="img/editor_contactwe.png" alt="小图标"/>
								</li>
							</ul>
						</div>
					</li>
				</ul>
				<ul class="model-content-url clearfix">
					<li class="active" data-url="1">
						<div>
							<img src="img/radiot_select.png" alt="未选中"/>
							<input type="checkbox"/>
							选择链接
						</div>
					</li>
					<li data-url="2">
						<div>
							<img src="img/radiot_noselect.png" alt="未选中"/>
							<input type="checkbox"/>
							自定义链接
						</div>
					</li>
				</ul>
				<div class="model-content-urlSel">
					<p class="model-content-sel open-sel clearfix" data-open="0">
						<span id="chamber-url">选择链接</span>
						<img src="img/list_dow.png" alt="xuanzhe"/>
					</p>
					<div class="select-list select-list-url">
						<i></i>
						<ul data-info="url" class="clearfix">
							<li>
								https://www.baidu.com/
							</li>
							<li>
								http://www.css88.com/doc/zeptojs_api/
							</li>
							<li>
								https://zhidao.baidu.com/question/981959867607562459.html
							</li>
							<li>
								https://zhidao.baidu.com/list?fr=daohang
							</li>
							<li>
								https://www.baidu.com/
							</li>
							<li>
								http://www.css88.com/doc/zeptojs_api/
							</li>
							<li>
								https://zhidao.baidu.com/question/981959867607562459.html
							</li>
							<li>
								https://zhidao.baidu.com/list?fr=daohang
							</li>
							<li>
								https://www.baidu.com/
							</li>
							<li>
								http://www.css88.com/doc/zeptojs_api/
							</li>
							<li>
								https://zhidao.baidu.com/question/981959867607562459.html
							</li>
							<li>
								https://zhidao.baidu.com/list?fr=daohang
							</li>
						</ul>
					</div>
					<input class="model-content-custom" type="text" placeholder="请输入链接"/>
				</div>
				<p class="model-content-btn">
					<a href="#" class="subInfo">保存</a>
				</p>
			</div>
		</div>
	</div>
	

	<script src="js/zepto.js"></script>
	<script src="js/touch.js"></script>
	<!-- 轮播插件 -->
	<script src="js/swiper-3.4.1.jquery.min.js"></script>
	<!-- jq颜色吸取插件 -->
	<script src="js/jscolor.js"></script>
	<script src="js/public.js"></script>
	<!-- jq拖拽事件 -->
	<script src="js/jquery-2.1.4.js"></script>
	<script src="js/jquery.panzoom.js"></script>
	<script src="js/jquery.mousewheel.js"></script>
	<script>
		(function() {
			var $section = $('.section').first();
			var sectionD = $section.find('.swiper-slide-main>p, .swiper-slide-main>div').panzoom({
				$zoomIn: $section.find(".zoom-in"),
				$zoomOut: $section.find(".zoom-out"),
				$zoomRange: $section.find(".zoom-range"),
				$reset: $section.find(".reset"),
				onEnd: function(e){
					var $tar = $(e.target)
					if($tar[0].nodeName != 'P'){
						$tar = $tar.parent()
					}
				},
			});
		})();

		$('.swiper-slide-main div p').on('click', function(e){
			$(e.target).css({display: 'none'}).next().css({display: 'block'}).val($(e.target).html())[0].focus()
		})

		$('.swiper-slide-main div textarea').on('blur', function(e){
			$(e.target).css({display: 'none'}).prev().css({display: 'block'}).html($(e.target).val())
		})

		var slImgDom = '';
		$('.swiper-slide-img').on('click', function(e){
			slImgDom = $(e.target)
			$('#upload_img').click()
		})

		$('#upload_img').on('change',function(e){
			var target = e.target
			var reg = /(\.jpg|\.png|\.jpeg)$/ig
			if(!/image\/\w+/.test(target.files[0].type)){
				alert("这个需要图片！");
				return false;
			}
			if(!reg.test(target.value)){
				alert('请选择JPG或者PNG格式的图片！')
				return
			}
			if (target.files[0]) {
				var reader = new FileReader()
				reader.onload = function(e){
					var img = e.target.result
					var imgURL = target.files[0]
					slImgDom.attr('src', img)
				}
			}
			reader.readAsDataURL(target.files[0])
		})



		var chamber = {}  // 宫格名称、颜色、图标、链接
		var  open_dom = '' // 保存所点击的dom
		var oldBgcolor = ''  //用户最后一次编辑并保存的颜色值

		function _editorText(e){
			var tar = $(e)
			tar.children('span').css({display: 'none'}).next('textarea').css({display: 'block'}).val( tar.children('span').html() )
		}
		$('.swiper-slide ul li textarea').on('blur', function(e){
			console.log(00)
		})
		// 官网名称input的绑定
		function _editorName(e){
			chamber.name = e.value
		}

		// 提交官网编辑信息
		$('.subInfo').on('click', function(){
			chamber.bgcolors = $('#chamber-bgcolor').val()
			open_dom.css({background: '#' + chamber.bgcolors})
			open_dom.children('.open-modal').next().attr('src',chamber.img )
			open_dom.children('span').html(chamber.name)
			open_dom.attr({'data-url': chamber.url})
			$('.model-box').css({display: 'none'})
		})

		// 编辑宫格
		$('.open-modal').on('click', function(e){
			var tar = $(e.target)
			open_dom = tar.parent()
			// 如果用户有过最后一次保存的颜色值，就保存在 chamber.bgcolors 中
			if( oldBgcolor ){
				chamber.bgcolors = oldBgcolor
			}else{
				chamber.bgcolors = open_dom.css('background-color')
			}
			chamber.name = open_dom.children('span').html()
			chamber.img = open_dom.children('.open-modal').next().attr('src')
			chamber.url = open_dom.attr('data-url')
			$('#chamber-bgcolor').val( chamber.bgcolors).css({background: chamber.bgcolors,color: 'transparent'})
			$('#chamber-img').attr({src: chamber.img})
			$('#chamber-name').val(chamber.name)
			$('#chamber-url').html(chamber.url)
			$('.model-box').css({display: 'table'})
		})

		// 点击弹出可供选择的小图标、链接模态框
		$('.open-sel').on('click', function(e){
			var tar = $(e.target)
			if(tar.attr('data-open') === undefined){
				tar = tar.parents('.open-sel')
			}
			if(tar.attr('data-open') == 0){
				$('.select-list').css({display: 'none'})
				$('.open-sel').attr('data-open', 0)
				tar.next('.select-list').css({display: 'block'})
				tar.attr('data-open', 1)
			}else{
				tar.attr('data-open', 0)
				tar.next('.select-list').css({display: 'none'})
			}
		})


		// 点击选择小图标、链接
		$('.select-list ul li').on('click', function(e){
			var tar = $(e.target)
			var key = tar.parents('ul.clearfix').attr('data-info')
			if(tar[0].nodeName != 'IMG' && tar.children().length ==0){
				tar.parents('.select-list').prev().find('span').html(tar.html())
				chamber[key] = tar.html()
			}else if(tar[0].nodeName == 'IMG'){
				tar.parents('.select-list').prev().find('#chamber-img').attr('src', tar.attr('src'))
				chamber[key] = tar.attr('src')
			}else if(tar.children()[0].nodeName == 'IMG'){
				tar.parents('.select-list').prev().find('#chamber-img').attr('src', tar.children().attr('src'))
				chamber[key] = tar.children().attr('src')
			}
			console.log(chamber)
		})


		// 点击切换选择或者自定义链接
		$('.model-content-url li').on('click', function(e){
			var tar = $(e.target)
			if(tar[0].nodeName != 'LI'){
				tar = tar.parents('li')
			}
			tar.addClass('active').siblings().removeClass('active').find('img').attr({src: 'img/radiot_noselect.png'})
			tar.find('img').attr({src: 'img/radiot_select.png'})
			tar.find('input')[0].checked = true
			tar.siblings().find('input')[0].checked = false
			if(tar.attr('data-url') == 1){
				$('.model-content-sel').css({display: 'block'})
				$('.model-content-custom').css({display: 'none'})
			}else{
				$('.model-content-sel').css({display: 'none'})
				$('.model-content-custom').css({display: 'block'})
				$('.model-content-custom')[0].focus()
			}
		})

		// 轮播函数
		var swiper = new Swiper('.swiper-container', {
			pagination: '.swiper-pagination',
			slidesPerView: 1,
			paginationClickable: true,
			spaceBetween: 30,
			//autoplay: 1000,
			autoplayDisableOnInteraction: false,
			loop: true
		});
   		// 点击隐藏模态框
		$('.model-box').on('click', function(e){
			var tar = $(e.target)
			if(tar .attr('data-wrapper') == 'wrapper'){
				$('.model-box').css({display: 'none'})
				open_dom = {}
			}
			if(tar.parents('.select-list').length == 0 &&
					tar.next().attr('data-open') === undefined &&
					tar.parents('.open-sel').length ==0 &&
					tar.attr('data-open') === undefined ){
				$('.open-sel').attr('data-open', 0)
				$('.select-list').css({display: 'none'})
			}
		})
	</script>
</body>

</html>